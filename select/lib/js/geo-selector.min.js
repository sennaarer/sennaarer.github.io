"use strict";(function(a){a.fn.geoSelector=function(h){var g="<div class='search-form'><input type='text' class='search'/></div>";var j="<div class='cities'><ul class='cities_list'></ul></div>";this.append(g);this.after().append(j);this.children("div").children("input").after('<ul class="result"></ul>');var b="http://evildevel.com/Test/Region";var c="http://evildevel.com/Test/City";var i=this;if(h){f(h,i);e(h,i)}d(i);function f(m,l){var k=l.children("div").children("input");a.getJSON(b).success(function(n){var o=n[m-1];k.val(o[1])})}function e(l,k){a.getJSON(c,{region:l}).success(function(m){a.each(m,function(o,n){k.children(".cities").children(".cities_list").append("<li>"+n[1]+"</li>")})})}function d(k){a.getJSON(b).success(function(p){var q=p;var o={};var m=false;var n=k.children("div").children("input");var l=k.children(".search-form").children(".result");n.on("keyup",function(t){var u=n.val();var s;if(n.val().length>2){if(u in o){r=o[u]}else{var r=a.grep(q,function(v){return v[1].search(RegExp(u,"i"))!=-1});o[u]=r}if(m==false){m=true;a(document).on("click",".list-item",function(){var x=a(this).attr("region_id");var w=a(this).parent(".result").parent(".search-form").parent("div");e(x,w);var v=w.children("div").children("input");v.val(a(this).text());l.empty();w.children(".cities").children(".cities_list").empty()})}else{l.empty()}for(s in r){l.append("<li class='list-item' region_id="+r[s][0]+">"+r[s][1]+"</li>")}}else{if(m){l.empty()}}})})}}})(jQuery);
//# sourceMappingURL=geo-selector.js.map
